---
name: pre-push
description: プッシュ前に最終チェックを実行します
---

# プッシュ前フック

## 実行するチェック

### 1. ブランチ確認
```bash
git branch --show-current
```
- `main`/`master`への直接プッシュは警告
- 保護ブランチへのプッシュは確認を求める

### 2. コミット履歴確認
```bash
git log origin/$(git branch --show-current)..HEAD --oneline
```
- WIPコミットがないか確認
- fixup/squashコミットがないか確認

### 3. テスト実行
全テストがパスすることを確認

### 4. Lintチェック
Lintエラーがないことを確認

### 5. ビルド確認
ビルドが成功することを確認

### 6. セキュリティスキャン
本番依存関係に高リスクの脆弱性がないことを確認

### 7. コミットメッセージ確認
プッシュされるコミットが:
- Conventional Commits形式に従っているか
- 意味のあるメッセージか

## チェック結果レポート

```
🚀 プッシュ前チェック

📋 チェック結果:
✅ ブランチ: feature/xxx (OK)
✅ コミット: X件 (WIPなし)
✅ テスト: XX件パス
✅ Lint: エラーなし
✅ ビルド: 成功
⚠️  セキュリティ: [警告があれば表示]

📊 変更サマリー:
- 変更ファイル: X
- 追加: +XX行
- 削除: -XX行

続行しますか？ [Y/n]
```

## 問題検出時の対応

### WIPコミットがある場合
```
⚠️  WIPコミットが含まれています

💡 提案:
- git rebase -i でコミットを整理
- git commit --amend でメッセージを修正
```

### テスト失敗の場合
```
❌ テストが失敗しました

💡 プッシュをキャンセルしました。テストを修正してください。
```

### mainブランチへの直接プッシュ
```
⚠️  警告: mainブランチへ直接プッシュしようとしています

💡 提案:
- feature/xxx ブランチを作成してPRを経由することを推奨

続行しますか？ [y/N]
```
